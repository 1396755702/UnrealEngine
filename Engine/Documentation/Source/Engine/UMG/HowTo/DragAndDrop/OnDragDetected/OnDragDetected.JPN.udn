INTSourceChangelist:3063666
Availability:Docs
Title:3.On Drag Detected
Crumbs: %ROOT%, Engine, Engine/UMG, Engine/UMG/HowTo
Description:ドラッグが検知された場合に、何を起こるかを設定します。
Related: Engine/UMG
Related: Engine/UMG/UserGuide
Version:4.12
SkillLevel:Intermediate

[VAR:Steps]
[OBJECT:Navigation]
	[PARAM:previous]
		[前のステップ](Engine\UMG\HowTo\DragAndDrop\WidgetSetup "%Engine\UMG\HowTo\DragAndDrop\WidgetSetup:title%")
	[/PARAM]
	[PARAM:current]
	[/PARAM]
	[PARAM:home]
		[ドラッグ＆ドロップのウィジェット](Engine\UMG\HowTo\DragAndDrop)
	[/PARAM]
	[PARAM:next]
		[次のステップ](Engine\UMG\HowTo\DragAndDrop\OnDrop)
	[/PARAM]
[/OBJECT]
[/VAR]

%Steps%

このステップでは、プレイヤーが実際にヘルスバーを画面上でドラッグすると何が起こるかを定義します。 

## ステップ

1.	**OnDragDetected** 関数を開いて、**右クリック** して、**WidgetDrag** を使用するように設定した **Create Drag Drop Operation** ノードを追加します。 

	![](DragDrop9.png)

	UMG には、ドラッグ＆ドロップの操作用にデフォルトのクラスがありますが、プロセスの一部として渡す追加の変数を持つカスタム クラスを作成しました。

1.	グラフ内を **右クリック** して、**Get Reference to Self** で以下のように接続し、**Pivot** のドロップダウンを **Mouse Down** に設定します。 

	![](DragDrop10.png)

	Pivot は、ドラッグ操作を行っているポインタと相対的にドラッグされる場合、Drag Widget Visual が表示される場所を決定します。 

1.	**[MyBlueprint]** パネルから **Drag Offset** 変数をドラッグして、それを以下のようにピンに接続します。 

	![](DragDrop11.png)

	ここでは、プレイヤーがウィジェット上をクリックした場所のベクター 2D 情報を渡し、OnDrop 操作の一部として使用します。 

1.	グラフ内を **右クリック** して、 **Remove from Parent** ノードを追加し、以下のように接続します。 

	![](DragDrop12.png)

	On Drag Detected プロセスを終了する前に、ドラッグしているウィジェットを表示から取り除きます。
	オリジナルの HealthBar ウィジェットを表示から取り除かないと、画面上でコピーをドラッグしている間デフォルト位置にとどまります。 
	このウィジェット自体は、プロセスの一部として渡されているため、このウィジェットの新規バージョンは作成しません。 

プレイヤーが左マウスボタンを放して OnDrop を行う場合、何が起こるかを決める必要があります。 
HealthBar ウィジェットを Main HUD Widget ブループリントに追加して、すべてをテストする前に表示するように指示する必要もあります。  

%Steps%

